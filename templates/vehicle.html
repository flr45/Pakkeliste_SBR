{% extends "base.html" %}{% block content %}
<h1>{{ v.name }}</h1>

<form id="veh-desc" method="post" action="/vehicle/{{ v.id }}/save_description" class="row gap">
  <textarea name="description" rows="3" placeholder="Kort beskrivelse..." style="width:100%">{{ v.description }}</textarea>
  <button class="btn" type="submit">Gem beskrivelse</button>
</form>

<form method="post" action="/vehicle/{{ v.id }}/upload_doc" enctype="multipart/form-data" class="row gap">
  <input type="file" name="file" required>
  <button class="btn" type="submit">Upload dokument</button>
</form>

<form method="post" action="/vehicle/{{ v.id }}/add_place" class="row gap">
  <input type="text" name="name" placeholder="Nyt rum/kasse..." required>
  <button class="btn" type="submit">TilfÃ¸j rum</button>
</form>

<input id="local-search" type="search" placeholder="SÃ¸g i dette kÃ¸retÃ¸j..." />

<div id="places">
  {% for p in v.places %}
  <details class="box" data-place-id="{{ p.id }}">
    <summary>
      <span contenteditable="true" class="place-name" data-pid="{{ p.id }}">{{ p.name }}</span>
      <span class="badge">{{ p.items_count }} enheder</span>
      <button class="icon btn-move" data-kind="place" data-id="{{ p.id }}" data-dir="up">â–²</button>
      <button class="icon btn-move" data-kind="place" data-id="{{ p.id }}" data-dir="down">â–¼</button>
    </summary>

    <form class="row gap add-item" onsubmit="return addItemInline(this);" data-pid="{{ p.id }}">
      <input type="text" name="name" placeholder="Nyt udstyr..." required>
      <input type="number" name="quantity" value="1" min="0">
      <input type="text" name="note" placeholder="Note">
      <button class="btn" type="submit">TilfÃ¸j</button>
    </form>

    <ul class="items" data-place="{{ p.id }}">
      {% for it in p.items_list %}
      <li data-item-id="{{ it.id }}">
        <span class="it-name">{{ it.name }}</span>
        <span class="it-qty">x{{ it.quantity }}</span>
        {% if it.photo_path %}
          <a href="{{ it.photo_path }}" target="_blank" title="Se billede">ðŸ“·</a>
        {% else %}
          <form method="post" action="/item/{{ it.id }}/upload_photo" enctype="multipart/form-data" class="inline-upload">
            <input type="file" name="file" accept="image/*" required>
            <button class="icon" title="Upload billede">ðŸ“·</button>
          </form>
        {% endif %}
        <button class="icon btn-move" data-kind="item" data-id="{{ it.id }}" data-dir="up">â–²</button>
        <button class="icon btn-move" data-kind="item" data-id="{{ it.id }}" data-dir="down">â–¼</button>
      </li>
      {% endfor %}
    </ul>
  </details>
  {% endfor %}
</div>
{% endblock %}

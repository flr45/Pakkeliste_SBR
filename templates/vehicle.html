{% extends "base.html" %}{% block content %}
<div class="card">
  <div class="row">
    <h2 style="margin:0">{{ v.name }}</h2><span class="spacer"></span>
    <form method="post" action="/vehicle/{{ v.id }}/delete" onsubmit="return confirm('Slet kÃ¸retÃ¸j?')"><button class="btn danger">Slet</button></form>
  </div>
  <form method="post" action="/vehicle/{{ v.id }}/description" class="row" style="margin-top:8px">
    <input type="text" name="description" placeholder="Kort beskrivelse" value="{{ v.description or '' }}" style="flex:1"><button class="btn small">Gem beskrivelse</button>
  </form>
  <form method="post" action="/vehicle/{{ v.id }}/doc" enctype="multipart/form-data" class="row" style="margin-top:8px">
    <input type="file" name="doc"><button class="btn small">Upload dokument</button>
    {% for d in v.docs %}<a class="btn small" href="{{ d.url }}" target="_blank">ðŸ“„ {{ d.original_name }}</a>{% endfor %}
  </form>
</div>
<div class="card" style="margin-top:12px">
  <div class="row">
    <input id="local-search" placeholder="SÃ¸g i dette kÃ¸retÃ¸jâ€¦" style="flex:1">
    <form method="post" action="/place/add" class="row" style="margin:0">
      <input type="hidden" name="vehicle_id" value="{{ v.id }}">
      <input name="name" placeholder="Nyt rum/kasse"><button class="btn small">TilfÃ¸j rum</button>
    </form>
  </div>
</div>
<div class="grid" id="places">
  {% for p in v.places %}
  <details class="place" id="place-{{ p.id }}">
    <summary class="summary">
      <span data-place-title data-place-id="{{ p.id }}"><b>{{ p.name }}</b></span>
      <span class="row"><span class="badge">{{ p.items|length }} enheder</span>
        <button class="btn small" onclick="movePlace({{p.id}}, 'up', this)">â–²</button>
        <button class="btn small" onclick="movePlace({{p.id}}, 'down', this)">â–¼</button>
      </span>
    </summary>
    <div class="place-body">
      <form method="post" action="/item/add" class="row">
        <input type="hidden" name="place_id" value="{{ p.id }}">
        <input name="name" placeholder="Nyt udstyr">
        <input name="quantity" placeholder="Antal" style="width:90px">
        <input name="note" placeholder="Note" style="flex:1">
        <button class="btn small">TilfÃ¸j</button>
      </form>
      <hr class="sep">
      {% for it in p.items %}
      <div class="item" data-item-name="{{ (it.name|lower|replace('-',' ')) }}">
        <div class="left">
          <span id="photo-icon-{{it.id}}" class="icon" style="visibility:{% if it.photo_path %}visible{% else %}hidden{% endif %}">ðŸ“·</span>
          <form method="post" action="/item/{{ it.id }}/save" class="row" style="gap:6px">
            <input name="name" value="{{ it.name }}" placeholder="Navn">
            <input name="quantity" value="{{ it.quantity }}" placeholder="Antal" style="width:80px">
            <input name="note" value="{{ it.note or '' }}" placeholder="Note" style="min-width:200px">
            <button class="btn small">Gem</button>
          </form>
        </div>
        <div class="row">
          <button class="btn small" onclick="triggerPhotoUpload({{it.id}})">TilfÃ¸j billede</button>
          <form method="post" action="/item/{{ it.id }}/delete" onsubmit="return confirm('Slet?')"><button class="btn small danger">Slet</button></form>
        </div>
      </div>
      {% else %}<div class="tag">Ingen udstyr i dette rum endnu.</div>{% endfor %}
    </div>
  </details>
  {% endfor %}
</div>
{% endblock %}
